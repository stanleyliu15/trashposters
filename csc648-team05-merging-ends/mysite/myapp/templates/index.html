{% extends 'layouts/base.html' %}
{% load staticfiles %}
{% block title %}
    <title>Home</title>
{% endblock %}

{% block styles %}
    <link rel="stylesheet" href="{% static 'css/home/index.css' %}">
{% endblock %}


{% block content %}
    <div class="container">
        <!-- Search -->
        <div class="row">
            <div class="col mt-4">
                <form id="search_div" action="" method="get">
                    <div class="form-group mb-0">
                        <label for="query">Search Environmental Issues</label>
                        <div class="input-group search-bar-container">
                            <!-- Filter by Post Menu -->
                            <span class="input-group-prepend">
                                {{ form.selection }} {{ form.value }}
                            </span>
                            <span class="input-group-append">
                                <button class="btn btn-outline-success border" type="submit">
                                    <i class="fa fa-search" id="search-addon"></i>
                                </button>
                            </span>
                    </div>
                </div>
            </form>
        </div>

        <!-- Create Post | Register to Post -->

        <!-- Feed -->
                {% if posts %}
                <ul>
                    {% for post in posts %}
                        {% include 'views/post/post_view.html' %}
                    {% endfor %}
                </ul>
            {% else %}
                <h3> No posts to display. :( </h3>
            {% endif %}
    </div>
{% endblock %}

{% block scripts %}
    <script src="{% static 'js/utils/resize_select.js' %}"></script>
    <script src="{% static 'js/searchBar.js' %}"></script>
    <script type="text/javascript">

        //submits search when enter is pressed
        $('#query').keypress(function (e) {
            if (e.which == 13)
                search();
        });

        function search() {
            var selection = $('#filter-post-menu').find(':selected').text().toLowerCase();
            var query = $('#query').val();
            window.location.href = "./search/" + selection + "=" + query;

        }
    </script>

{% endblock %}
